%此代码为1题2问的代码
m1=4866;%浮子质量
m2=2433;%振子质量
rho=1025;%海水密度
g=9.8;%小g
k1=80000;%弹簧系数
k2=250000;%扭转弹簧系数
m3=1335.535;%垂荡附加质量
freq=1.4005;%频率
T=1/freq;%周期
s=pi;
zeta1=656.3616;%垂荡兴波阻尼系数
sigma1=10000;%直线阻尼器系数
f=6250;%振幅
deltat=0.0001;%最小模拟时间间隔
v1=0;v2=0;%浮子/振子垂荡速度（以上方向为正）
a1=0;a2=0;%浮子/振子垂荡加速度（以上方向为正）
x1=0;x2=0;%浮子/振子离各自初始点相对位移（以上方向为正）
v1_rec=zeros(1,1000001);v2_rec=zeros(1,1000001);
x1_rec=zeros(1,1000001);x2_rec=zeros(1,1000001);%记录值
M1=0;M2=0;%浮子/振子所受力矩（以波浪推力方向为正，此处设为右向为正）
w1=0;w2=0;%浮子/振子角加速度（以波浪推力方向为正）
theta1=0;theta2=0;%浮子/振子离各自初始点相对角度（以波浪推力方向为正）
t=0;%当前时间
for i=1:1000000
    t=t+deltat;
    sigma1=10000*sqrt(abs(v1-v2));
    a1=(f*cos(freq*t)-k1*(x1-x2)-zeta1*v1-sigma1*(v1-v2)-rho*g*x1*s)/(m1+m3);%当x1大于1或小于-2时不适用
    a2=(sigma1*(v1-v2)+k1*(x1-x2))/m2;
    x1=x1+v1*deltat;
    x2=x2+v2*deltat;
    v1=v1+a1*deltat;
    v2=v2+a2*deltat;
    v1_rec(1,i+1)=v1;v2_rec(1,i+1)=v2;
    x1_rec(1,i+1)=x1;x2_rec(1,i+1)=x2;
end
figure;
plot([0:0.0001:100],x1_rec);
title('浮子相对初始位置位移');
xlabel('时间/s');
ylabel('位移/m');
figure;
plot([0:0.0001:100],x2_rec);
title('振子相对初始位置位移');
xlabel('时间/s');
ylabel('位移/m');
figure;
plot([0:0.0001:100],v1_rec);
title('浮子速度');
xlabel('时间/s');
ylabel({'速度','(m/s)'});
figure;
plot([0:0.0001:100],v2_rec);
title('振子速度');
xlabel('时间/s');
ylabel({'速度','(m/s)'});
figure;
plot([0:0.0001:100],x1_rec-x2_rec);
title('相对位移');
xlabel('时间/s');
ylabel('位移/m');
figure;
plot([0:0.0001:100],v1_rec-v2_rec);
title('相对速度');
xlabel('时间/s');
ylabel({'速度','(m/s)'});
v1_r=v1_rec(1:2000:286001);%每隔0.2s提取一次，其中28.56s时第40个周期结束，补为28.6s
v2_r=v2_rec(1:2000:286001);
x1_r=x1_rec(1:2000:286001);
x2_r=x2_rec(1:2000:286001);
ans_v1=v1_rec([100001,200001,400001,600001,1000001]);%10,20,40,60,100s的结果
ans_v2=v2_rec([100001,200001,400001,600001,1000001]);
ans_x1=x1_rec([100001,200001,400001,600001,1000001]);
ans_x2=x2_rec([100001,200001,400001,600001,1000001]);